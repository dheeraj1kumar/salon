{% extends "base.html" %}
{% block content %}

<style>
  body {
    background: linear-gradient(135deg, white 0%, white 100%);
    font-family: 'Poppins', sans-serif;
    color: #fff;
  }

  .reset-container {
    max-width: 450px;
    margin: 8vh auto;
    background: #fff;
    color: #333;
    padding: 2.5rem;
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    text-align: center;
    animation: fadeInUp 0.6s ease;
    margin-top: 200px;
    margin-bottom: 200px;
  }

  .reset-container h2 {
    margin-bottom: 1rem;
    font-size: 1.7rem;
    font-weight: 600;
    color: #764ba2;
  }

  .reset-container p {
    color: #666;
    font-size: 0.95rem;
    margin-bottom: 1.5rem;
  }

  .reset-container form {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .reset-container input[type="email"] {
    padding: 1rem;
    border: 2px solid #f0f0f0;
    border-radius: 12px;
    font-family: inherit;
    font-size: 0.95rem;
    transition: border-color .3s;
  }

  .reset-container input[type="email"]:focus {
    border-color: #667eea;
    outline: none;
  }

  .reset-container button {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 1rem;
    border-radius: 25px;
    cursor: pointer;
    font-weight: 600;
    transition: 0.3s;
  }

  .reset-container button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(102,126,234,0.3);
  }

  #reset-message {
    margin-top: 1rem;
    font-size: 0.9rem;
    font-weight: 500;
    min-height: 1.2rem;
  }

  @keyframes fadeInUp {
    from { opacity:0; transform:translateY(20px);}
    to { opacity:1; transform:translateY(0);}
  }
</style>

<div class="reset-container">
  <h2>Reset your password</h2>
  <p>Enter the email address associated with your account. Weâ€™ll send you a password reset link if it exists.</p>
  
  <form id="password-reset-form" method="post">
    {% csrf_token %}
    <input type="email" name="email" placeholder="Email address" required>
    <button type="submit">Send Reset Link</button>
  </form>
  
  <div id="reset-message"></div>
</div>

<script>
document.getElementById("password-reset-form").addEventListener("submit", async (e) => {
  e.preventDefault();
  const form = e.target;
  const msgBox = document.getElementById("reset-message");
  msgBox.innerHTML = "<span style='color:#764ba2'>Sending...</span>";
  try {
    const res = await fetch("{% url 'password_reset' %}", {
      method: "POST",
      headers: {
        "X-Requested-With": "XMLHttpRequest",
        "Accept": "application/json",
      },
      body: new FormData(form),
    });
    const data = await res.json();
    if (data.success) {
      msgBox.innerHTML = "<span style='color:green'>Check your email for reset instructions.</span>";
      setTimeout(() => window.location.href = "/", 1000);
      form.reset();
    } else {
      msgBox.innerHTML = "<span style='color:red'>" + (data.error || "Something went wrong.") + "</span>";
    }
  } catch (err) {
    msgBox.innerHTML = "<span style='color:red'>Network error.</span>";
  }
});
</script>

{% endblock %}
